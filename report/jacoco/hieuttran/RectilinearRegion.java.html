<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>RectilinearRegion.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">auction</a> &gt; <a href="index.source.html" class="el_package">hieuttran</a> &gt; <span class="el_source">RectilinearRegion.java</span></div><h1>RectilinearRegion.java</h1><pre class="source lang-java linenums">package hieuttran;

import java.math.BigDecimal;
import java.util.*;
import java.util.stream.Collectors;

public final class RectilinearRegion {
<span class="fc" id="L8">	private final Set&lt;Rectangle&gt; rectangles = new HashSet&lt;&gt;();</span>
	public Set&lt;Rectangle&gt; getRecs(){
<span class="nc" id="L10">		return rectangles;</span>
	}
<span class="fc" id="L12">	private RectilinearRegion(Set&lt;Rectangle&gt; rectangles) {</span>
<span class="fc" id="L13">		this.rectangles.addAll(rectangles);</span>
<span class="fc" id="L14">	}</span>
	
	private Set&lt;BigDecimal&gt; xCoord(){
<span class="nc" id="L17">		Set&lt;BigDecimal&gt; xCoord = new HashSet&lt;&gt;();</span>
<span class="nc bnc" id="L18" title="All 2 branches missed.">		for (Rectangle rec : getRecs()) {</span>
<span class="nc" id="L19">			xCoord.add(rec.left());</span>
<span class="nc" id="L20">			xCoord.add(rec.right());</span>
<span class="nc" id="L21">		}</span>
<span class="nc" id="L22">		return xCoord;</span>
	}
	
	private Set&lt;BigDecimal&gt; yCoord(){
<span class="nc" id="L26">		Set&lt;BigDecimal&gt; yCoord = new HashSet&lt;&gt;();</span>
<span class="nc bnc" id="L27" title="All 2 branches missed.">		for (Rectangle rec : getRecs()) {</span>
<span class="nc" id="L28">			yCoord.add(rec.top());</span>
<span class="nc" id="L29">			yCoord.add(rec.bottom());</span>
<span class="nc" id="L30">		}</span>
<span class="nc" id="L31">		return yCoord;</span>
	}
	
	public BiDimensionalMap&lt;Rectangle&gt; rectanglesMap(){
<span class="nc" id="L35">		BiDimensionalMap&lt;Rectangle&gt; grid = new BiDimensionalMap&lt;Rectangle&gt;(xCoord(), yCoord()); </span>
<span class="nc bnc" id="L36" title="All 2 branches missed.">		for (Rectangle rec : getRecs()) {</span>
<span class="nc" id="L37">			grid.slice(rec).addEverywhere(rec);</span>
<span class="nc" id="L38">		}</span>
<span class="nc" id="L39">		return grid;</span>
	}
	
	private boolean isOverlap(Rectangle r1, Rectangle r2) {
<span class="nc bnc" id="L43" title="All 2 branches missed.">		return !r1.equals(r2) &amp;&amp; </span>
<span class="nc bnc" id="L44" title="All 2 branches missed.">				r2.bottomLeft().compareTo(r1.bottomLeft()) &gt;= 0 &amp;&amp; </span>
<span class="nc bnc" id="L45" title="All 2 branches missed.">				r2.bottomLeft().compareTo(r1.topRight()) &lt; 0;</span>
	}
	
	public boolean isOverlapping() {
<span class="nc bnc" id="L49" title="All 2 branches missed.">		for (Rectangle r : getRecs()) {</span>
<span class="nc bnc" id="L50" title="All 2 branches missed.">			if (!getRecs().stream().noneMatch(rec -&gt; isOverlap(r, rec)))</span>
<span class="nc" id="L51">				return true;</span>
<span class="nc" id="L52">		}</span>
<span class="nc" id="L53">		return false;</span>
	}
	
	public  static  final RectilinearRegion of(Set&lt;Rectangle&gt; rectangles) {
<span class="fc" id="L57">		RectilinearRegion r = new RectilinearRegion(rectangles);</span>
<span class="pc bpc" id="L58" title="3 of 4 branches missed.">		if (!(Objects.isNull(rectangles) &amp;&amp; !r.isOverlapping()))</span>
<span class="fc" id="L59">			return r;</span>
<span class="nc" id="L60">		throw new IllegalArgumentException();</span>
	}

	public boolean areConnected(Rectangle rec1, Rectangle rec2){
<span class="fc bfc" id="L64" title="All 2 branches covered.">		return rec1.validate().left().compareTo(rec2.validate().right()) == 0 || //left side of the first rectangle touch the right side of the second rectangle</span>
<span class="fc bfc" id="L65" title="All 2 branches covered.">				rec1.right().compareTo(rec2.left()) == 0 || //right side of the first rectangle touch the left side of the second rectangle</span>
<span class="fc bfc" id="L66" title="All 2 branches covered.">				rec1.top().compareTo(rec2.bottom()) == 0 || //top side of the first rectangle touch the bottom side of the second rectangle</span>
<span class="fc bfc" id="L67" title="All 2 branches covered.">				rec1.bottom().compareTo(rec2.top()) == 0; //bottom side of the first rectangle touch the top side of the second rectangle</span>
	}

	/* no parameter
	@return whether the region is connected
	* */
	boolean isConnected(){
		//initialize the set of visited rectangles with the starting element is the first rectangle.
<span class="fc" id="L75">		Set&lt;Rectangle&gt; visitedRectangles = new HashSet();</span>
		//initialize the list of unvisited rectangles with the starting element is the first rectangle.
<span class="fc" id="L77">		Queue&lt;Rectangle&gt; unvisitedRectangles = new LinkedList&lt;&gt;();</span>
<span class="fc bfc" id="L78" title="All 2 branches covered.">		if (rectangles.isEmpty())</span>
<span class="fc" id="L79">			return true;</span>
<span class="fc" id="L80">		Rectangle initialRect = (Rectangle) rectangles.toArray()[0];</span>
<span class="fc" id="L81">		visitedRectangles.add(initialRect);</span>
<span class="fc" id="L82">		unvisitedRectangles.add(initialRect);</span>
		//while (the unvisited list is not empty)
<span class="fc bfc" id="L84" title="All 2 branches covered.">		while (unvisitedRectangles.size() != 0){</span>
			/* assign rtg to the first element in the unvisited list
			remove the first element in the list
			 */
<span class="fc" id="L88">			Rectangle rtg = unvisitedRectangles.poll();</span>
			//for each rectangle in rectangles
<span class="fc bfc" id="L90" title="All 2 branches covered.">			for (Rectangle rectangle : rectangles){</span>
				//if the set of visited rectangles contains rectangle: do nothing, skip
<span class="fc bfc" id="L92" title="All 2 branches covered.">				if (visitedRectangles.contains(rectangle.validate()))</span>
<span class="fc" id="L93">					;</span>
				//else if rtg and rectangle are connected:
<span class="fc bfc" id="L95" title="All 2 branches covered.">				else if (areConnected(rtg.validate(), rectangle.validate())){</span>
					//add rectangle to the visited set
<span class="fc" id="L97">					visitedRectangles.add(rectangle);</span>
					//insert rectangle to the first place of the unvisited list
<span class="fc" id="L99">					unvisitedRectangles.add(rectangle);</span>
				}
<span class="fc" id="L101">			}</span>
<span class="fc" id="L102">		}</span>
		//return (the size of the visited set equals the size of rectangles)
<span class="fc bfc" id="L104" title="All 2 branches covered.">		return visitedRectangles.size() == rectangles.size();</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>